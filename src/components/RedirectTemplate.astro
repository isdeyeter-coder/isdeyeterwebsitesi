---
// src/components/RedirectTemplate.astro
// G√úNCELLENDƒ∞ - Yeni JSON yapƒ±sƒ± i√ßin

import BasicLayout from '../layouts/BasicLayout.astro';
import config from '../pages/data/config.json';

// DEBUG: JSON yapƒ±sƒ±nƒ± kontrol et
console.log('üîç JSON YAPISI:', config);
console.log('üìû WHATSAPP:', config.whatsapp);

// YENƒ∞ JSON YAPINIZA G√ñRE DEƒûƒ∞≈ûKENLER
// D√úZ YAPI: { "company": "...", "whatsapp": "...", "blogUrl": "..." }
const companyName = config.company || "ƒ∞≈ü De Yeter";
const whatsappNumber = config.whatsapp || "905412465429"; // YENƒ∞ NUMARA
const blogUrlBase = config.blogUrl || "https://blog.isdeyeter.com";
const slogan = config.slogan || "Profesyonellerden Teklif Al, ƒ∞≈ülerini Bekletme, Kolayca Hallet!";
const buttonText = config.buttonText || "TEKLƒ∞F AL";
const whatsappText = config.whatsappText || "WhatsApp'tan Sor";

// Debug: WhatsApp numarasƒ±nƒ± kontrol et
console.log('‚úÖ ALINAN WHATSAPP:', whatsappNumber);
console.log('‚úÖ WHATSAPP URL:', `https://wa.me/${whatsappNumber}`);

// Props interface
export interface Props {
  customTitle?: string;
  category?: string;
  showBackButton?: boolean;
  customBlogUrl?: string;
}

const { 
  customTitle, 
  category, 
  showBackButton = false,
  customBlogUrl 
} = Astro.props;

// Dosya adƒ±ndan otomatik veri √ßƒ±kar
const extractPageData = () => {
  const pathSegments = Astro.url.pathname.split('/').filter(Boolean);
  const filename = pathSegments.pop() || '';
  const slug = filename.replace('.astro', '');
  
  let title = slug
    .replace(/-\d+$/, '')
    .replace(/-/g, ' ')
    .trim()
    .split(' ')
    .map(word => {
      const smallWords = ['ve', 'i√ßin', 'ile', 'de', 'da', 'ki'];
      if (smallWords.includes(word.toLowerCase())) return word.toLowerCase();
      return word.charAt(0).toUpperCase() + word.slice(1);
    })
    .join(' ');
  
  const turkishMap = { 'yas': 'ya≈ü', 'sirket': '≈üirket', 'is': 'i≈ü', 'cis': '√ßi≈ü' };
  Object.entries(turkishMap).forEach(([eng, tr]) => {
    title = title.replace(new RegExp(`\\b${eng}\\b`, 'gi'), tr);
  });
  
  return {
    title: customTitle || title,
    slug: slug,
    cleanSlug: slug.replace(/-\d+$/, ''),
    category: category || pathSegments[0] || 'hizmet'
  };
};

const pageData = extractPageData();
const whatsappMessage = `${pageData.title} hizmeti hakkƒ±nda detaylƒ± bilgi almak istiyorum.`;

// WHATSAPP URL OLU≈ûTURMA - EN KRƒ∞Tƒ∞K KISIM!
const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;

const blogSlug = pageData.slug.replace(/-\d+$/, '');
const blogUrl = customBlogUrl || `${blogUrlBase}/${blogSlug}`;

// Debug: T√ºm URL'leri kontrol et
console.log('üì± WHATSAPP MESAJ:', whatsappMessage);
console.log('üîó WHATSAPP URL (tam):', whatsappUrl);
console.log('üåê BLOG URL:', blogUrl);
---

<BasicLayout title={`${pageData.title} | ${companyName}`}>
  
  <style>
    /* Ana konteyner */
    .redirect-wrapper {
      min-height: 70vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .redirect-card {
      background: white;
      border-radius: 24px;
      padding: 60px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      max-width: 900px;
      width: 100%;
      text-align: center;
    }
    
    /* Ba≈ülƒ±k */
    .page-title {
      font-size: 3.5rem;
      font-weight: 800;
      color: #1F2937;
      margin-bottom: 20px;
      line-height: 1.2;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    /* SLOGAN - KIRMIZI, ƒ∞Kƒ∞ SATIR */
    .page-slogan {
      font-size: 1.8rem;
      color: #DC2626 !important;
      margin-bottom: 30px;
      font-weight: 600;
      line-height: 1.4;
    }
    
    .slogan-line1, .slogan-line2 {
      display: block;
    }
    
    /* A√áIKLAMA - ƒ∞Kƒ∞ SATIR */
    .page-description {
      font-size: 1.2rem;
      color: #6B7280;
      max-width: 700px;
      margin: 0 auto 50px;
      line-height: 1.7;
    }
    
    .description-line1, .description-line2 {
      display: block;
      margin-bottom: 8px;
    }
    
    /* Buton grubu */
    .action-buttons {
      display: flex;
      gap: 25px;
      justify-content: center;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    
    /* Ana butonlar */
    .action-button {
      padding: 20px 40px;
      border-radius: 15px;
      font-weight: 700;
      font-size: 1.2rem;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      min-width: 220px;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    
    .action-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: 0.5s;
    }
    
    .action-button:hover::before {
      left: 100%;
    }
    
    /* Teklif butonu */
    .btn-teklif {
      background: linear-gradient(135deg, #3B82F6, #1D4ED8);
      color: white;
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
    }
    
    .btn-teklif:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 35px rgba(59, 130, 246, 0.5);
    }
    
    /* WhatsApp butonu */
    .btn-whatsapp {
      background: linear-gradient(135deg, #25D366, #128C7E);
      color: white;
      box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
    }
    
    .btn-whatsapp:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 35px rgba(37, 211, 102, 0.5);
    }
    
    /* Kategori etiketi */
    .category-tag {
      display: inline-block;
      background: linear-gradient(135deg, #EFF6FF, #DBEAFE);
      color: #1D4ED8;
      padding: 10px 20px;
      border-radius: 50px;
      margin-bottom: 30px;
      font-weight: 600;
      font-size: 1rem;
      border: 2px solid #BFDBFE;
    }
    
    /* Geri butonu */
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: #6B7280;
      text-decoration: none;
      margin-top: 30px;
      padding: 10px 20px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }
    
    .back-link:hover {
      color: #3B82F6;
      background: #EFF6FF;
    }
    
    /* Debug panel */
    .debug-panel {
      background: #1F2937;
      color: #E5E7EB;
      padding: 20px;
      border-radius: 12px;
      margin-top: 40px;
      text-align: left;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .redirect-card {
        padding: 40px 25px;
      }
      
      .page-title {
        font-size: 2.5rem;
      }
      
      .page-slogan {
        font-size: 1.4rem;
      }
      
      .action-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .action-button {
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
  
  <!-- Ana i√ßerik -->
  <div class="redirect-wrapper">
    <div class="redirect-card">
      
      <!-- Kategori etiketi -->
      {pageData.category && (
        <div class="category-tag">
          <i class="fas fa-tag"></i> {pageData.category.toUpperCase()}
        </div>
      )}
      
      <!-- Ana ba≈ülƒ±k -->
      <h1 class="page-title">{pageData.title}</h1>
      
      <!-- SLOGAN - KIRMIZI, ƒ∞Kƒ∞ SATIR -->
      <h2 class="page-slogan">
        <span class="slogan-line1">Profesyonellerden Teklif Al,</span>
        <span class="slogan-line2">ƒ∞≈ülerini Bekletme, Kolayca Hallet!</span>
      </h2>
      
      <!-- A√áIKLAMA - ƒ∞Kƒ∞ SATIR -->
      <p class="page-description">
        <span class="description-line1">{pageData.title} hizmeti i√ßin en iyi profesyonellerden anƒ±nda teklif alƒ±n.</span>
        <span class="description-line2">Dilerseniz form doldurarak veya WhatsApp √ºzerinden hemen danƒ±≈ümanlarƒ±mƒ±zla ileti≈üime ge√ßebilirsiniz.</span>
      </p>
      
      <!-- Buton grubu -->
      <div class="action-buttons">
        <!-- Teklif Al butonu -->
        <a 
          href={blogUrl} 
          target="_blank" 
          rel="noopener noreferrer"
          class="action-button btn-teklif"
        >
          <i class="fas fa-bolt"></i>
          {buttonText}
        </a>
        
        <!-- WhatsApp butonu -->
        <a 
          href={whatsappUrl} 
          target="_blank" 
          rel="noopener noreferrer"
          class="action-button btn-whatsapp"
        >
          <i class="fab fa-whatsapp"></i>
          {whatsappText}
        </a>
      </div>
        
      <!-- Geri butonu -->
      {showBackButton && (
        <div>
          <a href="/" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Ana Sayfaya D√∂n
          </a>
        </div>
      )}
      
    </div>
  </div>
  
</BasicLayout>